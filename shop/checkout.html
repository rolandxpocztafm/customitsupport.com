<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Checkout - Custom IT Support Mining</title>

<link rel="icon" type="image/x-icon" href="/static/favicon.ico">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/feather-icons"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap');

body {
    font-family: 'Space Grotesk', sans-serif;
    background-color: #0f172a;
    color: #e2e8f0;
}

.content-card {
    background: rgba(15, 23, 42, 0.7);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 0.5rem;
}

.form-input {
    background: rgba(15, 23, 42, 0.5);
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: white;
}

.form-input:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 1px #3b82f6;
}
</style>
</head>

<body>

<section class="py-16">
<div class="container mx-auto px-4 max-w-6xl">
<h1 class="text-3xl font-bold mb-8 text-center">Checkout</h1>

<div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

<!-- ORDER SUMMARY -->
<div class="content-card p-6">
<h2 class="text-xl font-bold mb-6">Order Summary</h2>

<ul id="checkout-items" class="space-y-4 mb-6"></ul>

<div class="border-t border-slate-700 pt-4">
<div class="flex justify-between mb-2">
<span>Subtotal:</span>
<span id="subtotal">€0.00</span>
</div>

<div class="flex justify-between mb-2">
<span>Shipping:</span>
<span id="shipping">€0.00</span>
</div>

<div class="flex justify-between mb-2">
<span>VAT (21%):</span>
<span id="vat">€0.00</span>
</div>

<div class="flex justify-between text-lg font-bold mt-4 pt-4 border-t border-slate-700">
<span>Total:</span>
<span id="total">€0.00</span>
</div>
</div>
</div>

<!-- FORM -->
<div class="content-card p-6">

<form id="checkout-form"
action="https://formsubmit.co/rp@customitsupport.com"
method="POST"
class="space-y-4">

<input type="hidden" name="_subject" value="New Order - Custom IT Support Mining">
<input type="hidden" name="_captcha" value="false">
<input type="hidden" name="_next" value="https://customitsupport.com/shop/order-confirmation.html">
<input type="hidden" name="Cart Items" id="cart-data">
<input type="hidden" name="Order Summary" id="order-summary">
<input type="hidden" name="Shipping Price" id="shipping-hidden">

<div>
<label class="block text-sm mb-2">Full Name</label>
<input type="text" name="Full Name" class="w-full p-3 rounded-lg form-input" required>
</div>

<div>
<label class="block text-sm mb-2">Email</label>
<input type="email" name="Email" class="w-full p-3 rounded-lg form-input" required>
</div>

<div>
<label class="block text-sm mb-2">Phone</label>
<input type="tel" name="Phone" class="w-full p-3 rounded-lg form-input" required>
</div>

<div>
<label class="block text-sm mb-2">Address</label>
<input type="text" name="Address" class="w-full p-3 rounded-lg form-input" required>
</div>

<div class="grid grid-cols-2 gap-4">
<div>
<label class="block text-sm mb-2">Post Code</label>
<input type="text" name="Post Code" class="w-full p-3 rounded-lg form-input" required>
</div>

<div>
<label class="block text-sm mb-2">City</label>
<input type="text" name="City" class="w-full p-3 rounded-lg form-input" required>
</div>
</div>

<div>
<label class="block text-sm mb-2">Country</label>
<input type="text" name="Country" id="country-display" class="w-full p-3 rounded-lg form-input" readonly>
</div>

<button type="submit"
class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-medium mt-6 transition">
Complete Order
</button>

</form>
</div>
</div>
</div>
</section>

<script>
feather.replace();

document.addEventListener("DOMContentLoaded", () => {

const cart = JSON.parse(localStorage.getItem("cart")) || [];
if (cart.length === 0) {
window.location.href = "cart.html";
return;
}

const savedCountry = localStorage.getItem("shippingCountry") || "";
const savedShipping = parseFloat(localStorage.getItem("shippingPrice")) || 0;

document.getElementById("country-display").value = savedCountry;

const itemsEl = document.getElementById("checkout-items");
let subtotal = 0;

cart.forEach(item => {
const qty = item.quantity || 1;
const totalItem = item.price * qty;
subtotal += totalItem;

const li = document.createElement("li");
li.className = "flex justify-between border-b border-slate-700 pb-2";
li.innerHTML = `<span>${item.name} (x${qty})</span>
<span>€${totalItem.toFixed(2)}</span>`;
itemsEl.appendChild(li);
});

function calculateTotals() {
const shipping = savedShipping;
const vat = subtotal * 0.21;
const total = subtotal + shipping + vat;

document.getElementById("subtotal").textContent = `€${subtotal.toFixed(2)}`;
document.getElementById("shipping").textContent = `€${shipping.toFixed(2)}`;
document.getElementById("vat").textContent = `€${vat.toFixed(2)}`;
document.getElementById("total").textContent = `€${total.toFixed(2)}`;

return { shipping, vat, total };
}

const totals = calculateTotals();

document.getElementById("checkout-form").addEventListener("submit", function() {

let cartText = "";
cart.forEach(item => {
cartText += `${item.name} | Qty: ${item.quantity || 1} | €${item.price}\n`;
});

document.getElementById("cart-data").value = cartText;
document.getElementById("shipping-hidden").value = `€${totals.shipping.toFixed(2)}`;
document.getElementById("order-summary").value =
`Subtotal: €${subtotal.toFixed(2)}
Shipping: €${totals.shipping.toFixed(2)}
VAT: €${totals.vat.toFixed(2)}
Total: €${totals.total.toFixed(2)}`;

localStorage.removeItem("cart");
localStorage.removeItem("shippingCountry");
localStorage.removeItem("shippingPrice");

});

});
</script>

</body>
</html>
