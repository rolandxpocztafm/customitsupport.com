<!-- Fluminer T3 Profitability Calculator with Live BTC Data -->
<section id="calculator" class="py-16 bg-slate-900">
    <div class="container mx-auto px-6">
        <div class="max-w-4xl mx-auto profitability-calculator rounded-xl p-8">
            <h2 class="text-3xl font-bold mb-8 text-center">Fluminer T3 Profitability Calculator</h2>

            <!-- Live Data Display -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="bg-slate-800 rounded-lg p-4 text-center">
                    <div class="text-sm text-slate-400 mb-2">Bitcoin (BTC) Price</div>
                    <div id="btc-price" class="text-xl font-bold text-orange-400">Loading...</div>
                </div>
                <div class="bg-slate-800 rounded-lg p-4 text-center">
                    <div class="text-sm text-slate-400 mb-2">Network Difficulty</div>
                    <div id="btc-difficulty" class="text-xl font-bold text-blue-400">Loading...</div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <div class="mb-6">
                        <label for="electricity-cost" class="block text-sm font-medium mb-2">Electricity Cost ($/kWh)</label>
                        <input type="number" id="electricity-cost" value="0.0" step="0.01" min="0" class="w-full p-3 rounded-lg bg-slate-800 border border-slate-700 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <button id="calculate-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-medium transition duration-300">
                        Calculate Profitability
                    </button>
                </div>
                <div>
                    <div class="bg-slate-800 rounded-lg p-6">
                        <h3 class="text-xl font-semibold mb-4">Estimated Results</h3>
                        <div class="space-y-4">
                            <div class="flex justify-between"><span>Daily Revenue:</span><span id="daily-revenue">$0.00</span></div>
                            <div class="flex justify-between"><span>Daily Electricity Cost:</span><span id="daily-cost">$0.00</span></div>
                            <div class="flex justify-between"><span>Daily Profit:</span><span id="daily-profit">$0.00</span></div>
                            <div class="border-t border-slate-700 my-3"></div>
                            <div class="flex justify-between"><span>Monthly Profit:</span><span id="monthly-profit">$0.00</span></div>
                            <div class="flex justify-between"><span>ROI Period:</span><span id="roi-period">0 months</span></div>
                        </div>
                    </div>
                    <div class="mt-6 text-sm text-slate-400">
                        <p>Estimates based on current Bitcoin difficulty and market prices. Actual results may vary.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
async function updateBTCData() {
    try {
        const priceRes = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd');
        const priceData = await priceRes.json();
        const btcPrice = priceData.bitcoin.usd;

        const diffRes = await fetch('https://blockchain.info/q/getdifficulty');
        const btcDifficulty = await diffRes.text();

        document.getElementById('btc-price').textContent = `$${btcPrice.toLocaleString()}`;
        document.getElementById('btc-difficulty').textContent = parseFloat(btcDifficulty).toLocaleString();

        window.btcData = { btcPrice, btcDifficulty: parseFloat(btcDifficulty) };
    } catch (e) {
        console.error('Error loading BTC data:', e);
        document.getElementById('btc-price').textContent = 'Error';
        document.getElementById('btc-difficulty').textContent = 'Error';
    }
}

updateBTCData();
setInterval(updateBTCData, 60000);

document.getElementById('calculate-btn').addEventListener('click', async () => {
    const electricityCost = parseFloat(document.getElementById('electricity-cost').value);
    if (isNaN(electricityCost)) return alert('Enter valid electricity cost');

    const btcPrice = window.btcData?.btcPrice || 0;
    const hashrate = 115000; // GH/s
    const rewardRate = 4.173913043478261e-10; // BTC per GH/s per day
    const powerUsage = 1700; // Watts
    const minerPrice = 2310; // EUR

    const dailyReward = hashrate * rewardRate;
    const dailyRevenue = dailyReward * btcPrice;
    const dailyCost = (powerUsage * 24 / 1000) * electricityCost;
    const dailyProfit = dailyRevenue - dailyCost;
    const monthlyProfit = dailyProfit * 30;
    let roiPeriod = 'Not profitable';
    if (dailyProfit > 0) roiPeriod = Math.ceil(minerPrice / (dailyProfit * 30)) + ' months';

    document.getElementById('daily-revenue').textContent = '$' + dailyRevenue.toFixed(2);
    document.getElementById('daily-cost').textContent = '$' + dailyCost.toFixed(2);
    document.getElementById('daily-profit').textContent = '$' + dailyProfit.toFixed(2);
    document.getElementById('monthly-profit').textContent = '$' + monthlyProfit.toFixed(2);
    document.getElementById('roi-period').textContent = roiPeriod;
});
</script>
